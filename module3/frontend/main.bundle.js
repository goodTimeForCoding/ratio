(()=>{"use strict";const e=(e,n)=>{if(e.length!=n.length)return!1;for(var t=0;t<e.length;t++)if(e[t]!==n[t])return!1;return!0};let n,t,r,i,a,o=60,l="",s=1,L=1,M=1,T=0,c=0,H=0,u=0;const p=()=>{clearTimeout(n),s=1,L=1,M=1,T=0,c=0,H=0,u=0,l="00:00:00.00",document.userData.stopwatch.value=l},d=()=>{let e=(new Date).getTime()-t.getTime()-1e3*T;e>999&&T++,T>=L*o?(c=0,L++):(c=parseInt(H/100+T),c>=o&&(c-=(L-1)*o)),L>s*o?(M=1,s++):(M=parseInt(H/100+L),M>=o&&(M-=(s-1)*o)),H=Math.round(e/10),H>99&&(H=0),0==H&&(H="00"),H>0&&H<=9&&(H="0"+H),c>0?(a=c,c<10&&(a="0"+c)):a="00",i=M-1,i>0?i<10&&(i="0"+i):i="00",r=s-1,r>0?r<10&&(r="0"+r):r="00",l=r+":"+i+":"+a+"."+H,document.userData.stopwatch.value=l,n=setTimeout((()=>d()),1)},h=()=>{0==u?(p(),t=new Date,d(),u=1):(clearTimeout(n),u=0)},m=e=>{fetch("http://localhost:3004/api/v1/record/").then((e=>e.json())).then((n=>{e(n)})).catch((()=>{alert("Не удалось загрузить данные")}))},v=(e,n,t)=>{const r={name:e,time:n};fetch("http://localhost:3004/api/v1/record/",{method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json"}}).then((e=>{e.ok?m(t):alert("Ошибка HTTP: "+e.status)})).catch((()=>{alert("Не удалось отправить данные")}))},f=document.querySelector("#player").content.querySelector(".result"),y=document.querySelector(".results"),g=e=>{const n=f.cloneNode(!0);return n.querySelector(".player").textContent=e.name,n.querySelector(".time").textContent=e.time,n},I=e=>{for(;y.firstChild;)y.removeChild(y.firstChild);const n=document.createDocumentFragment();for(let t=0;t<e.length;t++){const r=g(e[t]);n.appendChild(r)}y.appendChild(n)};let E,D,C,w,b,k,S,q,x=document.querySelector("#start-game"),A=document.querySelector("#player-name"),X=document.querySelector(".grid"),Y=document.querySelector(".score"),j=document.querySelector(".status"),N=[];const O=()=>{A.checkValidity()?(document.userData.stopwatch.value="00:00:00.00",E=0,Y.innerHTML=0,P(),p(),t=new Date,d(),u=1,x.textContent="Начать заново"):alert("Введите имя!")},P=()=>{j.innerHTML=null,X.innerHTML=null,X.style="opacity: 1",N.splice(0,25);for(let e=0;e<25;e++){let e=document.createElement("div");e.innerHTML=0,X.appendChild(e),N.push(e)}J(),J(),X.addEventListener("mousedown",_),document.addEventListener("keydown",K),X.addEventListener("touchstart",te),X.addEventListener("touchend",re),X.addEventListener("mouseup",ne)},F=()=>{for(let e=0;e<25;e++)N[e].removeAttribute("class"),"0"!==N[e].textContent&&N[e].classList.add("x"+N[e].textContent)},J=()=>{let e=Math.floor(Math.random()*N.length);0==N[e].innerHTML?N[e].innerHTML=Math.random()>=.9?4:2:J(),F()},V=()=>{for(let n=0;n<25;n++)if(n%5==0){let t=N[n].innerHTML,r=N[n+1].innerHTML,i=N[n+2].innerHTML,a=N[n+3].innerHTML,o=N[n+4].innerHTML,l=[parseInt(t),parseInt(r),parseInt(i),parseInt(a),parseInt(o)],s=l.filter((e=>e)),L=5-s.length,M=Array(L).fill(0).concat(s);e(l,M)||(D=!0,N[n].innerHTML=M[0],N[n+1].innerHTML=M[1],N[n+2].innerHTML=M[2],N[n+3].innerHTML=M[3],N[n+4].innerHTML=M[4])}},z=()=>{for(let n=0;n<25;n++)if(n%5==0){let t=N[n].innerHTML,r=N[n+1].innerHTML,i=N[n+2].innerHTML,a=N[n+3].innerHTML,o=N[n+4].innerHTML,l=[parseInt(t),parseInt(r),parseInt(i),parseInt(a),parseInt(o)],s=l.filter((e=>e)),L=5-s.length,M=Array(L).fill(0),T=s.concat(M);e(l,T)||(D=!0,N[n].innerHTML=T[0],N[n+1].innerHTML=T[1],N[n+2].innerHTML=T[2],N[n+3].innerHTML=T[3],N[n+4].innerHTML=T[4])}},B=()=>{for(let n=0;n<5;n++){let t=N[n].innerHTML,r=N[n+5].innerHTML,i=N[n+10].innerHTML,a=N[n+15].innerHTML,o=N[n+20].innerHTML,l=[parseInt(t),parseInt(r),parseInt(i),parseInt(a),parseInt(o)],s=l.filter((e=>e)),L=5-s.length,M=Array(L).fill(0).concat(s);e(l,M)||(D=!0,N[n].innerHTML=M[0],N[n+5].innerHTML=M[1],N[n+10].innerHTML=M[2],N[n+15].innerHTML=M[3],N[n+20].innerHTML=M[4])}},G=()=>{for(let n=0;n<5;n++){let t=N[n].innerHTML,r=N[n+5].innerHTML,i=N[n+10].innerHTML,a=N[n+15].innerHTML,o=N[n+20].innerHTML,l=[parseInt(t),parseInt(r),parseInt(i),parseInt(a),parseInt(o)],s=l.filter((e=>e)),L=5-s.length,M=Array(L).fill(0),T=s.concat(M);e(l,T)||(D=!0,N[n].innerHTML=T[0],N[n+5].innerHTML=T[1],N[n+10].innerHTML=T[2],N[n+15].innerHTML=T[3],N[n+20].innerHTML=T[4])}},K=e=>{39===e.keyCode?(e.preventDefault(),U()):37===e.keyCode?(e.preventDefault(),W()):38===e.keyCode?(e.preventDefault(),$()):40===e.keyCode&&(e.preventDefault(),Z())},Q=()=>{for(let e=0;e<N.length;e++)if(2048==N[e].innerHTML){let e=A.value,n=document.userData.stopwatch.value;h(),v(e,n,I),j.innerHTML="Ты выиграл!",X.style="opacity: 0.5",x.addEventListener("click",O),X.removeEventListener("mousedown",_),document.removeEventListener("keydown",K),X.removeEventListener("touchstart",te),X.removeEventListener("touchend",re),X.removeEventListener("mouseup",ne)}},R=()=>{let e=0;for(let n=0;n<N.length;n++)0==N[n].innerHTML&&e++;for(let n=0;n<N.length-1;n++)N[n].innerHTML===N[n+1].innerHTML&&e++;for(let n=0;n<20;n++)N[n].innerHTML===N[n+5].innerHTML&&e++;0===e&&(h(),j.innerHTML="Ты проиграл!",X.style="opacity: 0.5",x.addEventListener("click",O),X.removeEventListener("mousedown",_),document.removeEventListener("keydown",K),X.removeEventListener("touchstart",te),X.removeEventListener("touchend",re),X.removeEventListener("mouseup",ne))},U=()=>{D=!1,V(),(()=>{for(let e=24;e>0;e--)if(N[e].innerHTML===N[e-1].innerHTML&&0!=N[e].innerHTML&&0!=N[e-1].innerHTML){let n=parseInt(N[e].innerHTML)+parseInt(N[e-1].innerHTML);N[e].innerHTML=n,N[e-1].innerHTML=0,E+=n,Y.innerHTML=E,D=!0}Q()})(),D&&J(),V(),F(),R()},W=()=>{D=!1,z(),(()=>{for(let e=0;e<24;e++)if(N[e].innerHTML===N[e+1].innerHTML&&0!=N[e].innerHTML&&0!=N[e+1].innerHTML){let n=parseInt(N[e].innerHTML)+parseInt(N[e+1].innerHTML);N[e].innerHTML=n,N[e+1].innerHTML=0,E+=n,Y.innerHTML=E,D=!0}Q()})(),D&&J(),z(),F(),R()},Z=()=>{D=!1,B(),(()=>{for(let e=24;e>4;e--)if(N[e].innerHTML===N[e-5].innerHTML&&0!=N[e].innerHTML&&0!=N[e-5].innerHTML){let n=parseInt(N[e].innerHTML)+parseInt(N[e-5].innerHTML);N[e].innerHTML=n,N[e-5].innerHTML=0,E+=n,Y.innerHTML=E,D=!0}Q()})(),D&&J(),B(),F(),R()},$=()=>{D=!1,G(),(()=>{for(let e=0;e<20;e++)if(N[e].innerHTML===N[e+5].innerHTML&&0!=N[e].innerHTML&&0!=N[e+5].innerHTML){let n=parseInt(N[e].innerHTML)+parseInt(N[e+5].innerHTML);N[e].innerHTML=n,N[e+5].innerHTML=0,E+=n,Y.innerHTML=E,D=!0}Q()})(),D&&J(),G(),F(),R()},_=e=>{b=e.pageX,k=e.pageY,1==e.which&&ee()},ee=()=>{X.addEventListener("mousemove",(e=>{e.preventDefault(),C=e.pageX,w=e.pageY}))},ne=e=>{if(1==e.which){e.preventDefault();let n=C-b,t=w-k,r=Math.abs(n)>Math.abs(t),i=Math.abs(t)>Math.abs(n);n>0&&r?U():n<0&&r?W():t>0&&i?Z():t<0&&i&&$(),C=0,w=0,X.removeEventListener("mousemove",(e=>{e.preventDefault(),C=e.pageX,w=e.pageY}))}},te=e=>{e.cancelable&&(e.preventDefault(),S=e.touches[0].pageX,q=e.touches[0].pageY)},re=e=>{if(e.cancelable){e.preventDefault();let n=e.changedTouches[0].pageX,t=e.changedTouches[0].pageY,r=n-S,i=t-q,a=Math.abs(r)>Math.abs(i),o=Math.abs(i)>Math.abs(r);r>0&&a?U():r<0&&a?W():i>0&&o?Z():i<0&&o&&$()}};m(I),x.addEventListener("click",O)})();
//# sourceMappingURL=main.bundle.js.map